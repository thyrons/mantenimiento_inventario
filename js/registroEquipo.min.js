$(document).on("ready",inicio);var formatoFecha={showButtonPanel:true,changeMonth:true,changeYear:true,dateFormat:"yy-mm-dd  "+getCurrentTime(),showAnim:"slide",};
var formatoFecha1={showButtonPanel:true,changeMonth:true,changeYear:true,dateFormat:"yy-mm-dd",showAnim:"slide",};var dialogos={autoOpen:false,resizable:false,width:760,height:400,modal:true,};
function Defecto(a){a.preventDefault();}function getCurrentTime(){var f="";try{var b=new Date();var e=b.getHours();var d=b.getMinutes();var c="A'M'";if(d<10){d="0"+d;
}if(e==12){e=12;c=" P'M'";}else{if(e==0){e=12;c=" A'M'";}else{if(e>12){e=e-12;c=" P'M'";}else{c=" A'M'";}}}f=""+e+":"+d+c+"";}catch(a){}return f;}function inicio(){jQuery("#list").jqGrid({url:"../xml/xmlRegistroEquipo.php",datatype:"xml",colNames:["Nro Registro","Nombres Cliente","Id Cliente","Fecha Ingreso","Fecha Salida","Nro. de Serie","Modelo","Id categoria","Tipo de Equipo","Id Marca","Marca","Id color","Nombre Color","Accesosios","Observaciones","Id Usuario","Registrado por","Id estado","Estado"],colModel:[{name:"txtRegistro",index:"txtRegistro",editable:true,align:"center",width:"100",search:false,frozen:true},{name:"txtCliente",index:"txtCliente",editable:true,align:"center",width:"150",search:true,frozen:true},{name:"txtClienteId",index:"txtClienteId",search:false,editable:false,hidden:true,editrules:{edithidden:false},align:"center",frozen:true,width:80},{name:"txtIngreso",index:"txtIngreso",editable:true,align:"center",width:"150",search:false,frozen:true},{name:"txtSalida",index:"txtSalida",editable:true,align:"center",width:"120",search:false,frozen:true},{name:"txtSerie",index:"txtSerie",editable:true,align:"center",width:"150",search:true,frozen:true},{name:"txtModelo",index:"txtModelo",editable:true,align:"center",width:"150",search:false,frozen:true},{name:"txtTipoEquipoId",index:"txtTipoEquipoId",search:false,editable:false,hidden:true,editrules:{edithidden:false},align:"center",frozen:true,width:80},{name:"txtTipoEquipo",index:"txtTipoEquipo",editable:true,align:"center",width:"150",search:true,frozen:true},{name:"txtMarcaId",index:"txtMarcaId",search:false,editable:false,hidden:true,editrules:{edithidden:false},align:"center",frozen:true,width:80},{name:"txtMarca",index:"txtMarca",editable:true,align:"center",width:"150",search:true,frozen:true},{name:"txtColorId",index:"txtColorId",search:false,editable:false,hidden:true,editrules:{edithidden:false},align:"center",frozen:true,width:80},{name:"txtColor",index:"txtColor",editable:true,align:"center",width:"150",search:true,frozen:true},{name:"txtAccesorios",index:"txtAccesorios",editable:true,align:"center",width:"150",search:false,frozen:true},{name:"txtObservaciones",index:"txtObservaciones",editable:true,align:"center",width:"150",search:false,frozen:true},{name:"id_user",index:"id_user",search:false,editable:false,hidden:true,editrules:{edithidden:false},align:"center",frozen:true,width:80},{name:"nombre_user",index:"nombre_user",editable:true,align:"center",width:"150",search:false,frozen:true},{name:"id_estado",index:"id_estado",search:false,editable:false,hidden:true,editrules:{edithidden:false},align:"center",frozen:true,width:80},{name:"Estado",index:"Estado",editable:true,align:"center",width:"150",search:true,frozen:true},],rowNum:10,rowList:[10,20,30],width:null,height:250,pager:jQuery("#pager"),sortname:"id_registro",shrinkToFit:false,sortorder:"asc",caption:"Lista Recursos",viewrecords:true,gridview:true,}).jqGrid("navGrid","#pager",{add:false,edit:false,del:false,refresh:true,search:true,view:true,},{recreateForm:true,closeAfterEdit:true,checkOnUpdate:true,reloadAfterSubmit:true,closeOnEscape:true,},{reloadAfterSubmit:true,closeAfterAdd:true,checkOnUpdate:true,reloadAfterSubmit:true,closeOnEscape:true,bottominfo:"Todos los campos son obligatorios son obligatorios"},{width:300,closeOnEscape:true},{sopt:["eq","bw"],multipleSearch:false,overlay:false},{closeOnEscape:true,width:400,},{closeOnEscape:true,});
jQuery("#list").jqGrid("navButtonAdd","#pager",{caption:"Modificar",onClickButton:function(){var b=jQuery("#list").jqGrid("getGridParam","selrow");if(b){var a=jQuery("#list").jqGrid("getRowData",b);
jQuery("#list").jqGrid("GridToForm",b,"#formRegistroEquipo");$("#bRegistros").dialog("close");}else{alert("Seleccione un fila");}}});jQuery("#list").jqGrid("navButtonAdd","#pager",{caption:"PDF",onClickButton:function(){var b=jQuery("#list").jqGrid("getGridParam","selrow");
if(b){var a=jQuery("#list").jqGrid("getRowData",b);window.open("../reportes/reportes/reporteRegistro.php?id="+a.txtRegistro);}else{alert("Seleccione un fila");
}}});$("#botones a").on("click",Defecto);$("#bRegistros").dialog(dialogos);$("#btnBuscar").on("click",abrirDialogo);$("#btnGuardar").on("click",guardarRegistro);
$("#btnModificar").on("click",modificarRegistro);$("#txtIngreso").datepicker(formatoFecha);$("#txtSalida").datepicker(formatoFecha1);$("#btnGuardar").button({icons:{primary:"ui-icon-disk"},});
$("#btnModificar").button({icons:{primary:"ui-icon-pencil"},});$("#btnBuscar").button({icons:{primary:"ui-icon-search"},});$("#btnReporte").button({icons:{primary:"ui-icon-document"},});
$("#txtColor").autocomplete({source:"../procesos/busquedaColor.php",minLength:1,focus:function(a,b){$("#txtColor").val(b.item.value);$("#txtColorId").val(b.item.label);
return false;},select:function(a,b){$("#txtColor").val(b.item.value);$("#txtColorId").val(b.item.label);return false;}}).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append("<a>"+b.value+"</a>").appendTo(a);
};$("#txtCliente").autocomplete({source:"../procesos/busquedaCliente.php",minLength:1,focus:function(a,b){$("#txtCliente").val(b.item.value);$("#txtClienteId").val(b.item.label);
return false;},select:function(a,b){$("#txtCliente").val(b.item.value);$("#txtClienteId").val(b.item.label);return false;}}).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append("<a>"+b.value+"</a>").appendTo(a);
};$("#txtTipoEquipo").autocomplete({source:"../procesos/busquedaEquipo.php",minLength:1,focus:function(a,b){$("#txtTipoEquipo").val(b.item.value);$("#txtTipoEquipoId").val(b.item.label);
return false;},select:function(a,b){$("#txtTipoEquipo").val(b.item.value);$("#txtTipoEquipoId").val(b.item.label);return false;}}).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append("<a>"+b.value+"</a>").appendTo(a);
};$("#txtMarca").autocomplete({source:"../procesos/busquedaMarca.php",minLength:1,focus:function(a,b){$("#txtMarca").val(b.item.value);$("#txtMarcaId").val(b.item.label);
return false;},select:function(a,b){$("#txtMarca").val(b.item.value);$("#txtMarcaId").val(b.item.label);return false;}}).data("ui-autocomplete")._renderItem=function(a,b){return $("<li>").append("<a>"+b.value+"</a>").appendTo(a);
};$.ajax({type:"POST",url:"../procesos/contadorRegistro.php",success:function(a){val=a;$("#txtRegistro").val(val);}});}function guardarRegistro(a){if($("#txtIngreso").val()!=""&&$("#txtSalida").val()!=""&&$("#txtTipoEquipoId").val()!=""&&$("#txtClienteId").val()!=""&&$("#txtMarcaId").val()!=""&&$("txtColorId").val()!=""){$.ajax({type:"POST",url:"../procesos/procesosRegistroEquipo.php",data:"txtRegistro="+$("#txtRegistro").val()+"&txtClienteId="+$("#txtClienteId").val()+"&txtIngreso="+$("#txtIngreso").val()+"&txtTipoEquipoId="+$("#txtTipoEquipoId").val()+"&txtModelo="+$("#txtModelo").val()+"&txtSerie="+$("#txtSerie").val()+"&txtColorId="+$("#txtColorId").val()+"&txtMarcaId="+$("#txtMarcaId").val()+"&txtObservaciones="+$("#txtObservaciones").val()+"&txtAccesorios="+$("#txtAccesorios").val()+"&txtSalida="+$("#txtSalida").val()+"&tipo=g",success:function(b){val=b;
if(val==0){alert("Datos Guardados");id=$("#txtRegistro").val();window.open("../reportes/reportes/reporteRegistro.php?id="+id);limpiarDatos();$("#txtRegistro").val(parseInt(id)+1);
}if(val==1){alert("Error.. durante el proceso");}}});}else{alert("Llene todos los campos antes de continuar");}}function modificarRegistro(a){if($("#txtIngreso").val()!=""&&$("#txtSalida").val()!=""&&$("#txtTipoEquipoId").val()!=""&&$("#txtClienteId").val()!=""&&$("#txtMarcaId").val()!=""&&$("txtColorId").val()!=""){$.ajax({type:"POST",url:"../procesos/procesosRegistroEquipo.php",data:"txtRegistro="+$("#txtRegistro").val()+"&txtClienteId="+$("#txtClienteId").val()+"&txtIngreso="+$("#txtIngreso").val()+"&txtTipoEquipoId="+$("#txtTipoEquipoId").val()+"&txtModelo="+$("#txtModelo").val()+"&txtSerie="+$("#txtSerie").val()+"&txtColorId="+$("#txtColorId").val()+"&txtMarcaId="+$("#txtMarcaId").val()+"&txtObservaciones="+$("#txtObservaciones").val()+"&txtAccesorios="+$("#txtAccesorios").val()+"&txtSalida="+$("#txtSalida").val()+"&tipo=m",success:function(b){val=b;
if(val==0){alert("Datos Modificados");$("#txtRegistro").val("");location.reload();}if(val==1){alert("Error.. durante el proceso");}}});}else{alert("Llene todos los campos antes de continuar");
}}function limpiarDatos(){$("input").val("");$("textarea").val("");}function abrirDialogo(a){$("#bRegistros").dialog("open");}